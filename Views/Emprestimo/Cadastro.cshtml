@model CadEmprestimoViewModel
@{
    ViewData["Title"] = "Cadastro de Emprestimos";
}

<h1 class="row justify-content-md-center">Cadastro de Empréstimo</h1>
<div class="row justify-content-md-center">
    <form asp-action="Cadastro" method="POST" id="script_newempres" class="col-md-4">
        <fieldset>
            <legend>Usuario</legend>
            <div class="form-group">
                <label asp-for="Emprestimo.NomeUsuario">Nome</label>
                <input asp-for="Emprestimo.NomeUsuario" id="nomeUser" class="form-control"/>
            </div>
            <div class="form-group">
                <label asp-for="Emprestimo.Telefone">Telefone</label>
                <input asp-for="Emprestimo.Telefone" id="telUser" class="form-control"/>
            </div>
        </fieldset>
        <fieldset>
            <legend>Livro</legend>
            <div class="form-group">
                <label asp-for="Emprestimo.DataEmprestimo">Data de Empréstimo</label>
                <input type="date" asp-for="Emprestimo.DataEmprestimo" id="dataEmp" class="form-control"/>
            </div>
            <div class="form-group">
                <label asp-for="Emprestimo.DataDevolucao">Data de Devolução</label>
                <input type="date" asp-for="Emprestimo.DataDevolucao" id="dataDev" class="form-control"/>
            </div>
            <div class="form-group">
                <label asp-for="Emprestimo.LivroId">Livro</label>
                <select asp-for="Emprestimo.LivroId" id="livroEmp" class="form-control">
                    @foreach(Livro l in Model.Livros)
                    {
                        <option value="" selected hidden>Selecione</option>
                        <option value="@l.Id">@l.Titulo</option>
                    }
                </select>
            </div>
        </fieldset>
        <input type="submit" value="Salvar" class="btn btn-primary"/>
    </form>
</div>

<script>
    document.getElementById("script_newempres").addEventListener("submit", function validateNewLivro(e)
    {
        var nomeUser = document.getElementById("nomeUser").value;
        var telUser = document.getElementById("telUser").value;
        var dataEmp = document.getElementById("dataEmp").value;
        var dataDev = document.getElementById("dataDev").value;
        var livroEmp = document.getElementById("livroEmp").value;
        var errors = "";

        if (nomeUser.trim() === "")
        {
            errors = errors + "Nome do usuário.\n";
        }

        if (telUser.trim() === "")
        {
            errors = errors + "Telefone do usuário.\n";
        }

        if (dataEmp.trim() === "")
        {
            errors = errors + "Data de empréstimo.\n";
        }

        if (dataDev.trim() === "")
        {
            errors = errors + "Data de devolução.\n";
        }

        if (livroEmp.trim() === "")
        {
            errors = errors + "Livro a ser emprestado.\n";
        }
        
        if (errors != "")
        {
            alert("Existem campos obrigatórios que não foram preenchidos:\n\n" + errors);
            e.preventDefault();
        }
    });
</script>